<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NextRide | Cars for Sale</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet"/>
<meta http-equiv="Cache-Control" content="no-store"/>
<style>
:root{ --teal:#0E3539; --ivory:#F2F0EA; --muted:#9EB3B2; --orange:#F07424; --card:#0b2326; }
*{box-sizing:border-box}
body{ margin:0; font-family:Poppins,system-ui,Arial,sans-serif; color:var(--ivory); background: var(--teal); min-height:100dvh; }
.wrap{max-width:1024px;margin:0 auto;padding:26px}
.card{ background:#0b2326; border-radius:26px; padding:28px 22px; border:1px solid rgba(255,255,255,.12); box-shadow:0 18px 42px rgba(0,0,0,.45), 0 0 26px rgba(14,53,57,.28); position:relative; }
header{text-align:center;margin-bottom:12px}
.subtitle{color:var(--muted);margin-top:0px;font-size:1rem;text-align:center}
.divider{height:2px;background:linear-gradient(90deg,transparent,var(--orange),transparent);margin:18px 0}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:22px;align-items:stretch}
.car{ background:#102a2d; border:1px solid rgba(255,255,255,.08); border-radius:18px; overflow:hidden; box-shadow:0 10px 28px rgba(0,0,0,.28); display:flex;flex-direction:column; position:relative; }
.car img{width:100%;aspect-ratio:4/3;object-fit:cover;background:#0b2326;display:block}
.car-body{padding:12px 14px 6px}
.car h3{margin:0 0 6px;font-weight:700;font-size:16px;color:var(--ivory);cursor:pointer;text-decoration:underline dotted transparent}
.car h3:hover{ text-decoration-color: rgba(255,255,255,.5) }
.meta{color:var(--muted);font-size:13px;line-height:1.4;margin-bottom:8px}
.price{font-weight:700;color:var(--ivory);margin-bottom:6px}
.cta{padding:12px 14px 14px;border-top:1px dashed rgba(255,255,255,.08)}
.btn{ display:block;width:100%;text-align:center;text-decoration:none;font-weight:700;padding:12px 14px;border-radius:28px;background:linear-gradient(90deg,var(--orange), #ffb37e);color:#102326; box-shadow:0 8px 20px rgba(240,116,36,.35); transition:transform .18s ease, filter .18s ease, box-shadow .18s ease; }
.btn:hover{transform:translateY(-1px);filter:brightness(1.03)}
.brand{display:flex;align-items:center;gap:12px;justify-content:center}
footer{color:var(--muted);text-align:center;font-size:12px;margin-top:16px}

/* SELO SOLD */
.sold-flag{
  position:absolute;
  top:10px;
  left:10px;
  background:rgba(239,68,68,0.85); /* vermelho com 85% */
  color:#fff;
  font-weight:800;
  font-size:24px;
  border-radius:999px;
  padding:12px 24px;
  box-shadow:0 6px 16px rgba(0,0,0,.35);
  pointer-events:none;
  text-transform:uppercase;
}

/* MODAL */
#modal{ position:fixed; inset:0; display:none; place-items:center; z-index:9999; }
/* ... resto do CSS sem alteraÃ§Ãµes ... */
</style>
</head>
<body>
<div class="wrap">
 <div class="card">
   <!-- ... header igual ... -->
   <section class="grid" id="cars"></section>
   <!-- ... resto igual ... -->
 </div>
</div>

<!-- ... modal igual ... -->

<script>
const WHATSAPP = "353876342891";
const PUBLIC_JSON = './cars.json';
const fmtEUR = n => new Intl.NumberFormat('en-IE',{style:'currency',currency:'EUR'}).format(Number(n||0));
const grid = document.getElementById('cars');

function sanitizeList(list){
  if(!Array.isArray(list)) return [];
  return list.map(c => ({
    id: c.id || crypto.randomUUID(),
    titulo: c.titulo || c.title || '',
    marca: c.marca || c.brand || '',
    modelo: c.modelo || c.model || '',
    ano: c.ano || c.year || '',
    km: c.km || c.mileage || '',
    preco: c.preco || c.price || '',
    foto: c.foto || c.photo || c.image || '',
    desc: c.desc || c.description || '',
    contato: c.contato || c.contact || '',
    sold: !!c.sold,   // ðŸ‘ˆ IMPORTANTE
    fotos: Array.isArray(c.fotos)?c.fotos:[]
  }));
}

function render(list){
  grid.innerHTML = '';
  if(!list.length){
    grid.innerHTML = '<div class="meta" style="text-align:center;padding:20px">No cars published yet.</div>';
    return;
  }
  list.forEach((c, idx)=>{
    const el = document.createElement('article'); 
    el.className='car';
    if(c.sold){ 
      const soldTag = document.createElement('div'); 
      soldTag.className='sold-flag'; 
      soldTag.textContent='SOLD'; 
      el.appendChild(soldTag);
    }
    const img = document.createElement('img'); 
    img.src = c.foto || 'logo.png'; 
    img.alt = c.titulo || 'Car photo'; 
    el.appendChild(img);

    const body = document.createElement('div'); body.className='car-body';
    const meta = [c.ano?`Year ${c.ano}`:null, c.km?(`${Number(c.km).toLocaleString('en-IE')} km`):null, c.marca, c.modelo].filter(Boolean).join(' â€¢ ');
    const titleText = c.titulo || (c.marca+' '+(c.modelo||''));
    body.innerHTML = `<h3 data-idx="${idx}">${titleText}</h3><div class="meta">${meta}</div><div class="price">${fmtEUR(c.preco)}</div>`;
    el.appendChild(body);

    const cta = document.createElement('div'); cta.className='cta';
    const a = document.createElement('a'); a.className='btn'; a.target='_blank'; a.rel='noopener';
    a.href = `https://wa.me/${WHATSAPP}?text=Hello! I'm interested in the ${titleText}`; 
    a.textContent = "I'm interested";
    cta.appendChild(a); el.appendChild(cta);

    grid.appendChild(el);
  });
}

// carregar dados
(async()=>{
  try{
    const r = await fetch(PUBLIC_JSON + '?t=' + Date.now(), {cache:'no-store'});
    if(r.ok){
      const data = await r.json();
      render(sanitizeList(data));
    }
  }catch(e){ console.error(e); }
})();
</script>
</body>
</html>
